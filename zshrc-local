# -*- mode: sh -*-
# vim: set ft=sh:

fpath=(/usr/local/share/zsh-completions ~/.zsh/completions $fpath)

alias emd="emacs --daemon"
alias emdk="emacsclient -e '(kill-emacs)'"
alias em="emacsclient -t"
alias emx="emacsclient -nc"
alias gpa="gp --all"
alias dk="docker"
alias dc="docker-compose"
alias dip='dk inspect --format "{{ .NetworkSettings.IPAddress }}"'
alias dke="dk exec -it"
alias dkl='dk logs -f --tail=100'

export PATH=/usr/local/bin:/usr/bin:/bin:/usr/local/sbin:/usr/sbin:/sbin:/usr/X11/bin
export VIRTUAL_ENV_DISABLE_PROMPT='Y'
export EDITOR="vim"
export TERM="xterm-256color"
export MAVEN_OPTS="-Xmx512m -XX:MaxPermSize=128M"

export LC_ALL=en_US.UTF-8
export LANG=en_US.UTF-8

platform=`uname`
if [[ "$platform" == 'Darwin' ]]; then
    export JAVA_HOME=`/usr/libexec/java_home -v 1.8`
fi

# virtualenvwrapper
VIRTUALENVWRAPPER_PYTHON=/usr/local/bin/python3
which virtualenvwrapper.sh 2>&1 > /dev/null && export WORKON_HOME=$HOME/.virtualenvs && source `which virtualenvwrapper.sh`

# docker hack
export DOCKER_API_VERSION=1.22

# nvm
NVM_SCRIPT="/usr/local/opt/nvm/nvm.sh"
if [ -f $NVM_SCRIPT ]; then
    export NVM_DIR="$HOME/.nvm"
    source $NVM_SCRIPT
fi

# lua
export PATH=$PATH:~/.luarocks/bin

# private
if [ -f ~/.zshrc-private ]; then
    source ~/.zshrc-private
fi

source ~/.iterm2_shell_integration.`basename $SHELL`

# other

function recode {
    if [ -z $1 ]; then
        echo "invalid file name\nusage: $0 file-name [cp1251 [utf8]]"
        return;
    fi
    local filename=$1
    local from_encoding=${2:=cp1251}
    local to_encoding=${3:=utf8}
    iconv -f $from_encoding -t $to_encoding $filename | sponge $filename
}

